<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Commuters every year</title>
       <link rel="stylesheet" href="CoomutersAcctCSS.css">
       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
       <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
       <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <style>
    /*navbar responsive*/
.topnav {
  overflow: hidden;
  background-color: #3D5A80;
  height: 67px;
  padding-left: 80px;
}

.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #04AA6D;
  color: white;
}

.topnav .icon {
  display: none;
}

@media screen and (max-width: 600px) {
  .topnav a:not(:first-child) {display: none;}
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  
}
  </style>
  <body>
    <div class="topnav" id="myTopnav">
      <nav class="nav">
        <div class="logo-content">
          <div class="logo">
            <a href="index.html">
              <img src="images/logo.png"></a>
                <div class="logo-name">Commuter's Account</div>
                <button id="logout" onclick="window.location.href='login.html'">Logout</button>
            </div>
        </div>
    </nav>
    </div>

    <div class="sidebar">
        <i class='bx bx-menu' id="btn"></i>
        <ul class="navList">
            <li>
                <a href="adminProfile.html">
                <img src="images/admin.png">
                <span class="links_name">Admin Profile</span>
                </a>
                <span class="tooltip">Admin</span>
            </li>
            <li>
                <a href="announcement.html">
                <img src="images/announcement.png">
                <span class="links_name">Announcement</span>
                </a>
                <span class="tooltip">Announcement</span>
            </li>
            <li>
                <a href="ShuttleDriverAcct.html">
                <img src="images/Shuttle Drivers Account.png">
                <span class="links_name">Shuttle Driver’s Account</span>
                </a>
                <span class="tooltip">Driver</span>
            </li>
            <li>
                <a href="CoomutersAcct.html">
                <img src="images/Commuters Account.png">
                <span class="links_name">Commuter’s Account</span>
                </a>
                <span class="tooltip">Commuter</span>
            </li>
            <li>
                <a href="complaintsNfeedback.html">
                <img src="images/Complaints and Feedbacks.png">
                <span class="links_name">Complaints and Feedbacks</span>
                </a>
                <span class="tooltip">Complaints</span>
            </li>
            <li>
                <a href="boundaryRemit.html">
                <img src="images/Boundary Remittance.png">
                <span class="links_name">Boundary Remittance</span>
                </a>
                <span class="tooltip">Boundary</span>
            </li>
            <li>
                <a href="reload.html">
                  <!--img src="images/reload.png"!-->
                  <i class='bx bx-wallet'></i>
                <span class="links_name">Reload</span>
                </a>
                <span class="tooltip">Reload</span>
            </li>
            <li>
              <a href="withdrawal.html">
                <!--img src="images/reload.png"!-->
                <i class='bx bx-money-withdraw'></i>
              <span class="links_name">Withdraw</span>
              </a>
              <span class="tooltip">Withdraw</span>
          </li>
        </ul>
    </div>

    <div class="btn-container">
      <div class="btn">
        <a href="guest.html">
          <button type="button" name="button" id="guest">Guest List</button>
        </a>
        <a href="#print">
          <button type="submit" onclick="window.print()" id="btnPrint">PRINT</button>
        </a>
      </div>
    </div>

    <div id="dvContents" class="tableDiv">
      <center><h1 id="tableTitle" style="display: none">Commuter's Account</h1></center>
      <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
        <!-- bootstrap link for the table -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
        <table id="example" class="display" width="100%" cellspacing="0">
          <thead>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>Address</th>
            <th>Username</th>
            <th id="ControlCenter">Control Center</th>
          </thead>
          <tbody id="tbody1"></tbody>
        </table>
      </div>

      <!-- Modal starts here-->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Driver's Account</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="new-user-form">
        <center><img id="myimg" height="200px" width="200px" hidden> <label id="upProgress" hidden> </label>
          <input type="text" id="namebox" name="namebox" placeholder="Picture's name here" hidden>
          <!-- <button id="upload"> Upload Profile </button> <br> -->
          <!-- <button id="retrieve" onclick="getProf()">Load profile</button>  -->
        </center> <br>

        <label class="labs">Full name:</label>
        <input type="text" name= "Fname" id="Fname" disabled> <br>

        <label class="labs">Phone Number:</label>
        <input type="text" id="num" name="num" disabled> <br>

        <label class="labs">Address:</label>
        <input type="text" id="address" name="address" disabled> <br>

        <label class="labs">Username:</label>
        <input type="text" name= "uname" id="uname" disabled> <br>

        <label class="labs">Email:</label>
        <input type="email" id="eeemail" name="eeemail" disabled> <br>

        <label class="labs">Status:</label>
        <input type="text" id="status" name="status" disabled> <br>
      </div>

      <div class="modal-footer">
        <!-- <button id="updBtn" type="button" class="btn btn-success" onclick="Upd()">Update</button> -->
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="viewProf" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content" id="idModalContent">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Commuter's ID</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <iframe id="viewprof_iframe" src="idlayout.html" frameborder="100" height="600" width="750"></iframe>
      </div>
        </div>
      </div>
      </div>
      </div>
<!-- modal ends here -->

<footer class="footer-distributed">

        <div class="footer-left">
            <h3>Washington <span>Place</span></h3>

            <p class="footer-links">
                <a href="index.html">Dashboard</a>
                |
                <a href="commutersTable.html">All commuters</a>
                |
                <a href="login.html">Log in</a>
            </p>

            <p id="coltext">DOWNLOAD OUR APP HERE:</p>
            <div class="content">
              <p><a href="https://drive.google.com/drive/folders/1JACHKQU4GNaF3-ca2-VM0jZ3Qa-Z6ZCL"> For commuters click here </a></p>
              <p><a href="https://drive.google.com/drive/folders/1JACHKQU4GNaF3-ca2-VM0jZ3Qa-Z6ZCL"> For drivers click here </a></p>
            </div>
        </div>

        <div class="footer-center">
            <div>
                <i class="fa fa-map-marker"></i>
                <p><span>Sampaloc II, Dasmariñas,</span>
                    <strong>Philippines</strong></p>
            </div>

            <div>
                <i class="fa fa-phone"></i>
                <p>0943 302 9424</p>
            </div>
            <div>
                <i class="fa fa-envelope"></i>
                <p><a href="mailto:peteregencia@yahoo.com">peteregencia@yahoo.com</a></p>
            </div>
            <div>
                <i class="fa fa-facebook"></i>
                <p><a href="https://www.facebook.com/cavitewashington">Washington Place facebook page</a></p>
            </div>
            <div>
              <p class="footer-company-name">Copyright © 2022 <strong>WashingtonPlaceDasmarinas</strong> <br>
                All rights reserved</p>
            </div>
        </div>
        <div class="footer-right">
            <p class="footer-company-about">
                <span>About Washington Place Dasmarinas</span>
                <strong>Washington Place Dasmarinas</strong> Stateland’s newest and to date, the
                grandest development, is set to rise in the emerging city of Dasmariñas in Cavite. Encompassing 40
                hectares of prime property along Aguinaldo Highway, it is envisioned to become a landmark community
                that boasts of modern-themed architectural designs.
            </p>
            <!--div class="footer-icons">
                <a href="https://www.facebook.com/cavitewashington"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-linkedin"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-youtube"></i></a>
            </div!-->
        </div>
    </footer>
    </body>

<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-storage.js"></script>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

<script>
  //configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyBfq-ptJkg7y-hJpyJrVq8x0PNoM4fT7cY",
        authDomain: "shuttle-go-8d87a.firebaseapp.com",
        databaseURL: "https://shuttle-go-8d87a-default-rtdb.firebaseio.com",
        projectId: "shuttle-go-8d87a",
        storageBucket: "shuttle-go-8d87a.appspot.com",
        messagingSenderId: "509853219067",
        appId: "1:509853219067:web:5e6b7fb55bbdba9cc0985e",
        measurementId: "G-3YGP2PY9QX"
      };
      firebase.initializeApp(firebaseConfig);

      alert("Di pa maayos si Guest table. This alert is from the Guest webpage")

      //select all data
      function Select_AllData(){
        firebase.database().ref('Commuters').once('value', function (snapshot){
          snapshot.forEach(function(childSnapshot){
            var name = childSnapshot.val().first_Name + " " + childSnapshot.val().last_Name;
            var emaily = childSnapshot.val().email;
            var add = childSnapshot.val().address;
            var statusy = childSnapshot.val().status;
            var num = childSnapshot.val().phone_Number;
            var unamey = childSnapshot.val().username;
            AddItemToTable(name, emaily, statusy, add, num, unamey);
      });
    });
  }
      // window.onload = Select_AllData;

      //table filling
      var studentNo = 0;
      var stdList = [];

      var firstName = document.getElementById('Fname');
      var address = document.getElementById('address');
      var email = document.getElementById('eeemail');
      var status = document.getElementById('status');
      var phonenum = document.getElementById('num');
      var username = document.getElementById('uname');
      var profname = document.getElementById("namebox");

      function AddItemToTable(name, emaily, statusy, add, num, unamey){
        var tbody1 = document.getElementById("tbody1");
        let trow = document.createElement("tr");
        let td0 = document.createElement("tr");
        let td1 = document.createElement("td");
        let td2 = document.createElement("td");
        let td3 = document.createElement("td");
        let td4 = document.createElement("td");
        let td5 = document.createElement("td");

        stdList.push([name, emaily, statusy, add, num, unamey]);

        td0.innerHTML = ++studentNo;
        td1.innerHTML = name;
        td2.innerHTML = emaily;
        td3.innerHTML = add;
        td4.innerHTML = unamey;
        td5.innerHTML = num;
        trow.appendChild(td0);
        trow.appendChild(td1);
        trow.appendChild(td2);
        trow.appendChild(td3);
        trow.appendChild(td4);
        trow.appendChild(td5);

        var ControlDiv = document.createElement("div");
        ControlDiv.innerHTML = '<button type="button" id= "addAcct" class="btn btn-primary my-2 ml-2" onclick="FillTboxes('+studentNo+')" data-toggle="modal" data-target="#exampleModalCenter">View account</button>'

        trow.appendChild(ControlDiv);
        tbody1.appendChild(trow);
      }

      function AddAllItems(boundary) {
        studentNo=0;
            tbody1.innerHTML="";
            boundary.forEach(element => {
              AddItemToTable(element.first_Name + " " + element.last_Name , element.email, element.status, element.phone_Number, element.username, element.address)
            });
          }

          function getAllData() {
              const dbref = firebase.database().ref("Commuters");
              get(child(dbref, "Commuters"))
              .then((snapshot) => {
                var commuter = [];
                snapshot.forEach(childSnapshot => {
                  commuter.push(childSnapshot.val());
                });
                AddAllItems(commuter);
              })
          }

          function getAllDataRT() {
              const dbRef = firebase.database().ref("Commuters");
              
              dbRef.on('value', (snapshot)=>{

                var commuters = [];
                snapshot.forEach(childsnapshot => {
                  commuters.push(childsnapshot.val());
                });
                AddAllItems(commuters);
              })
          }
          window.onLoad = getAllDataRT();

      function FillTboxes(index){
        if(index == null){
          firstName.value = "";
          address.value = "";
          email.value = "";
          status.value = "";
          phonenum.value = "";
          uname.value = "";

        }else if(email.value === stdList[index]){
          alert("Email already exist");
        }
        else{
          --index;

          firstName.value = stdList[index][0];
          phonenum.value = stdList[index][3];
          address.value = stdList[index][5];
          uname.value = stdList[index][4];
          email.value = stdList[index][1];
          document.getElementById("status").value = stdList[index][2];
        }
      }

      //updating accounts
      function Upd(){
      var status = document.getElementById('status').value;
      firebase.database().ref("Commuters/" + phonenum.value).update(
         {
          email: email.value,
          firstName: firstName.value,
          status: status,
          address: address.value,
          phonenum: phonenum.value,
          username: username.value
         },
         (error)=>{
           if(error){
             alert("Account was not updated!" + error);
           }else{
             alert("Account updated!");
             $("#exampleModalCenter").modal('hide'); //exampleModalCenter is the id of the modal component
           }
         }
       )
     }
</script>

  <script>
    let btn= document.querySelector("#btn");
    let sidebar= document.querySelector(".sidebar");
    btn.onclick= function(){
      sidebar.classList.toggle("active");
    }
  </script>
</html>
