<!DOCTYPE html>
<html>
    <head> <title>Boundary Remittance</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="boundaryRemitCSS.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
        <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
        <!-- font awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Adding firebaseUI authenticaion -->
    <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />
    
  </head>
  <style>
    body {font-family: Arial, Helvetica, sans-serif;}
    
    /* The Modal (background) */
    .modal {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1; /* Sit on top */
      padding-top: 100px; /* Location of the box */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: rgb(0,0,0); /* Fallback color */
      background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }
    
    /* Modal Content */
    .modal-content {
      background-color: #fefefe;
      margin: auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
    }
    
    /* The Close Button */
    .close {
      color: #aaaaaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    
    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

/*navbar responsive*/
.topnav {
  overflow: hidden;
  background-color: #3D5A80;
  height: 67px;
  padding-left: 80px;
}

.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #04AA6D;
  color: white;
}

.topnav .icon {
  display: none;
}

@media screen and (max-width: 600px) {
  .topnav a:not(:first-child) {display: none;}
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  
}

    </style>
    

    <!-- printing css starts here  -->
    <style id="table_style" type="text/css">
      table td #paid, #pending, #balance{
        width: 90px;
        height: 26px;
        background: #4caf50;
        border-radius: 11px;
        border-color: transparent;
        font-weight: 700;
        font-size: 14px;
        line-height: 15px;
        letter-spacing: 1.5px;
        color: #E0FBFC;
      }
      #pending{
        background: #FFA000;
      }
      #balance{
        background: #d60000;
      }
      @media print{
        table td #paid, #pending, #balance{
          color: #4caf50;
          background-color: red;
        }
        #pending{
          color: #FFA000;
        }
        #balance{
          color: #d60000;
        }
        table
        {
            border: transparent;
        }
        #example_length label, #example_filter label{ /*show entries number and search*/
          display: none;
        }
      }
      </style>
      <!-- printing css ends here  -->
    <body>

      <div class="topnav" id="myTopnav">
        <nav class="nav">
          <div class="logo-content">
            <div class="logo">
              <a href="dashboard.html">
                <img src="images/logo.png"></a>
                  <div class="logo-name">Boundary Remittance</div>
                  <button id="logout" onclick="window.location.href='login.html'">Logout</button>
              </div>
          </div>
      </nav>
      </div>

      <div class="sidebar">
          <i class='bx bx-menu' id="btn"></i>
          <ul class="navList">
              <li>
                  <a href="adminProfile.html">
                  <img src="images/admin.png">
                  <span class="links_name">Admin Profile</span>
                  </a>
                  <span class="tooltip">Admin</span>
              </li>
              <li>
                  <a href="announcement.html">
                  <img src="images/announcement.png">
                  <span class="links_name">Announcement</span>
                  </a>
                  <span class="tooltip">Announcement</span>
              </li>
              <li>
                  <a href="ShuttleDriverAcct.html">
                  <img src="images/Shuttle Drivers Account.png">
                  <span class="links_name">Shuttle Driver’s Account</span>
                  </a>
                  <span class="tooltip">Driver</span>
              </li>
              <li>
                  <a href="CoomutersAcct.html">
                  <img src="images/Commuters Account.png">
                  <span class="links_name">Commuter’s Account</span>
                  </a>
                  <span class="tooltip">Commuter</span>
              </li>
              <li>
                  <a href="complaintsNfeedback.html">
                  <img src="images/Complaints and Feedbacks.png">
                  <span class="links_name">Complaints and Feedbacks</span>
                  </a>
                  <span class="tooltip">Complaints</span>
              </li>
              <li>
                  <a href="boundaryRemit.html">
                  <img src="images/Boundary Remittance.png">
                  <span class="links_name">Boundary Remittance</span>
                  </a>
                  <span class="tooltip">Boundary</span>
              </li>
              <li>
                  <a href="reload.html">
                    <!--img src="images/reload.png"!-->
                  <i class='bx bx-wallet'></i>
                  <span class="links_name">Reload</span>
                  </a>
                  <span class="tooltip">Reload</span>
              </li>
              <li>
                <a href="withdrawal.html">
                  <!--img src="images/reload.png"!-->
                  <i class='bx bx-money-withdraw'></i>
                <span class="links_name">Withdraw</span>
                </a>
                <span class="tooltip">Withdraw</span>
            </li>
          </ul>
      </div>
        
          <div class="btn-container">
            <div class="btn">
              <a href="#print">
                <button type="submit" onclick="PrintTable();" id="btnPrint">PRINT</button>
              </a>
            </div>
          </div>

          <div id="dvContents" class="tableDiv">
          <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
          <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>

          <table id="example" class="display" width="100%" cellspacing="0">
            <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>RECEIPT</th>
              <th>Contact Number</th>
              <th>Date</th>
              <th>Time</th>
              <th>Amount</th>
              <th>Status</th>
              <th>Update Status</th>
            </tr>
          </thead>
          <tbody id="tbody1"></tbody>
      
<!-- The Modal -->
<div id="seemoreModal">
  <div class="seemoremodal-content">
  <div class="seemoreModal-header">
    <button type="button" class="close" data-dismiss="modal">&times;</button>
  </div>
  <div class="seemoreModal-body">
    <div id="receiptCont">
      <center>
        <img id="myimg" height="200px" width="200px"> <br>
        <form> <br><br>
      <label for="csname" id="csnamelabel">Driver's Name: </label>
      <input type="text" id="csname" name="csname" value="Maria Anders" disabled>
      <br>
      <label for="amount">Boundary Amount: </label>
      <input type="text" id="amount" name="amount" value="P 1000.00" disabled>
    </form>
  </center>
      <div class="buttons">
        <a href="#accepted"><button class="accept"><i class="fa fa-check-circle"></i> Accept</button></a>
        <a href="reload.html"><button class="decline"><i class="fa fa-times-circle"></i> Decline</button></a>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Modal ends here-->

      </table>
    </div>
    <footer class="footer-distributed">

        <div class="footer-left">
            <h3>Washington <span>Place</span></h3>

            <p class="footer-links">
                <a href="dashboard.html">Dashboard</a>
                |
                <a href="commutersTable.html">All commuters</a>
                |
                <a href="login.html">Log in</a>
            </p>

            <p id="coltext">DOWNLOAD OUR APP HERE:</p>
            <div class="content">
              <p><a href="https://drive.google.com/file/d/1d8tUT5DQuuEI0k3D9PMNzJ99qE45hrwl/view?usp=sharing"> For commuters click here </a></p>
              <p><a href="https://drive.google.com/file/d/1d8tUT5DQuuEI0k3D9PMNzJ99qE45hrwl/view?usp=sharing"> For drivers click here </a></p>
            </div>
        </div>

        <div class="footer-center">
            <div>
                <i class="fa fa-map-marker"></i>
                <p><span>Sampaloc II, Dasmariñas,</span>
                    <strong>Philippines</strong></p>
            </div>

            <div>
                <i class="fa fa-phone"></i>
                <p>0943 302 9424</p>
            </div>
            <div>
                <i class="fa fa-envelope"></i>
                <p><a href="mailto:peteregencia@yahoo.com">peteregencia@yahoo.com</a></p>
            </div>
            <div>
                <i class="fa fa-facebook"></i>
                <p><a href="https://www.facebook.com/cavitewashington">Washington Place facebook page</a></p>
            </div>
            <div>
              <p class="footer-company-name">Copyright © 2022 <strong>WashingtonPlaceDasmarinas</strong> <br>
                All rights reserved</p>
            </div>
        </div>
        <div class="footer-right">
            <p class="footer-company-about">
                <span>About Washington Place Dasmarinas</span>
                <strong>Washington Place Dasmarinas</strong> Stateland’s newest and to date, the
                grandest development, is set to rise in the emerging city of Dasmariñas in Cavite. Encompassing 40
                hectares of prime property along Aguinaldo Highway, it is envisioned to become a landmark community
                that boasts of modern-themed architectural designs.
            </p>
            <!--div class="footer-icons">
                <a href="https://www.facebook.com/cavitewashington"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-linkedin"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-youtube"></i></a>
            </div!-->
        </div>
    </footer>

    
    <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-database.js"></script>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script id="MainScript">

            const firebaseConfig = {
                    apiKey: "AIzaSyBfq-ptJkg7y-hJpyJrVq8x0PNoM4fT7cY",
                    authDomain: "shuttle-go-8d87a.firebaseapp.com",
                    databaseURL: "https://shuttle-go-8d87a-default-rtdb.firebaseio.com",
                    projectId: "shuttle-go-8d87a",
                    storageBucket: "shuttle-go-8d87a.appspot.com",
                    messagingSenderId: "509853219067",
                    appId: "1:509853219067:web:5e6b7fb55bbdba9cc0985e",
                    measurementId: "G-3YGP2PY9QX"
                  };
                  firebase.initializeApp(firebaseConfig);

                console.log(firebase);

      //select all data
      function Select_AllData(){
        firebase.database().ref('boundary').once('value', function (snapshot){
          snapshot.forEach(function(childSnapshot){
            var driverr = childSnapshot.val().driver;
            var receiptt = childSnapshot.val().receiptt;
            var email22 = childSnapshot.val().amount;
            var datee = childSnapshot.val().date;
            var stats = childSnapshot.val().status;
            var timee = childSnapshot.val().time;
            var num = childSnapshot.val().contact;
          
            AddItemToTable(driverr, receiptt, email22,stats, datee, timee, num);
          });
        });
      }
      // window.onload = Select_AllData;

       //table filling
       var studentNo = 0;
      var stdList = [];
      

        function AddItemToTable(driverr, receiptt, email22,stats, datee, timee, num){
        var tbody1 = document.getElementById("tbody1");
        let trow = document.createElement("tr");
        let td0 = document.createElement("td");
        let td1 = document.createElement("td");
        let td2 = document.createElement("td");
        let td3 = document.createElement("td");
        let td4 = document.createElement("td");
        let td5 = document.createElement("td");
        let td6 = document.createElement("td");
        let td7 = document.createElement("td");
        let td8 = document.createElement("td");
       

        stdList.push([driverr, receiptt, email22,stats, datee, timee, num]);
        

        td0.innerHTML = ++studentNo;
        td1.innerHTML = driverr;
        td2.innerHTML = receiptt;
        td3.innerHTML = num;
        td4.innerHTML = timee;
        td5.innerHTML = datee;
        td6.innerHTML = email22;
        td7.innerHTML = stats;

        
        var ControlDiv2 = document.createElement("div2");
        ControlDiv2.innerHTML ='<td id="receipt"> <a href="#exampleModalCenter" id="viewBtn1">' +
                          '<button id="myBtn" onclick="FillTboxes('+studentNo+')" data-toggle="modal" data-target="#seemoreModal">View Receipt</button></a>'

        trow.appendChild(td0);
        trow.appendChild(td1);
        trow.appendChild(ControlDiv2);
        trow.appendChild(td3);
        trow.appendChild(td4);
        trow.appendChild(td5);
        trow.append(td6);
        trow.appendChild(td7);

        var ControlDiv = document.createElement("div");
        ControlDiv.innerHTML = '<select id="status'+studentNo+'" onchange="Update('+studentNo+')">' + 
                        '<option>Status</option>' +
                        '<option value="Paid">Paid</option>' +
                        '<option value="Pending">Pending</option>' +
                        '<option value="Unpaid">Unpaid</option>' +
                        '</select>' + 
                        '<input hidden id="h_text'+studentNo+'">'

        trow.appendChild(ControlDiv);
        tbody1.appendChild(trow);

        // color customization not working properly
        // function Paid(){
        // firebase.database().ref('boundary').orderByChild('status').equalTo('Paid').once('value', function(snapshot){
        //           td7.style.fontFamily  = "Salsa";
        //           td7.style.color = "#4caf50";
        //           td7.style.borderRadius  = "11px";
        //           td7.style.fontWeight  = "400";
        //           td7.style.fontSize  = "small";
        //         });
        //       }
        
        // function Pending(){
        //   firebase.database().ref('boundary').orderByChild('status').equalTo('Pending').once('value', function(snapshot){
        //           td7.style.fontFamily  = "Salsa";
        //           td7.style.color = "#ce9a00";
        //           td7.style.borderRadius  = "11px";
        //           td7.style.fontWeight  = "400";
        //           td7.style.fontSize  = "small";
        //         });
        //       }

        // function Unpaid(){
        //         firebase.database().ref('boundary').orderByChild('status').equalTo('Unpaid').once('value', function(snapshot){
        //           td7.style.fontFamily  = "Salsa";
        //           td7.style.color = "#d60000";
        //           td7.style.borderRadius  = "11px";
        //           td7.style.fontWeight  = "400";
        //           td7.style.fontSize  = "small";
        //         });
        //       }
      }

      function AddAllItems(boundary) {
        studentNo=0;
            tbody1.innerHTML="";
            boundary.forEach(element => {
              AddItemToTable(element.driver, element.receipt , element.amount, element.status, element.time, element.date, element.contact)
            });
          }

          
          function getAllData() {
              const dbref = firebase.database().ref("boundary");
              get(child(dbref, "boundary"))
              .then((snapshot) => {
                var commuter = [];
                snapshot.forEach(childSnapshot => {
                  commuter.push(childSnapshot.val());
                });
                AddAllItems(commuter);
              })
          }

          function getAllDataRT() {
              const dbRef = firebase.database().ref("boundary");

              dbRef.on('value', (snapshot)=>{
                var commuters = [];
                snapshot.forEach(childsnapshot => {
                  commuters.push(childsnapshot.val());
                });
                AddAllItems(commuters);
              })
          }

          window.onLoad = getAllDataRT();

      //updating accounts
      function Update(index){
        var status = document.getElementById('status'+index).value;
        var tryy = document.getElementById('h_text'+index);
        --index;
        tryy.value = stdList[index][0];
              firebase.database().ref("boundary/" + tryy.value).update(
                  {
                    status: status
                  },
                  (error)=>{
                    if(error){
                      alert("Account was not updated " + error);
                    }else{
                      alert("Account successfully updated!");
                    }
                  }
                )
          }

            //img retrieval process
          function FillTboxes(index){
            var ImgNAme = document.getElementById('h_text'+index);
            var tryy = document.getElementById('h_text'+index);
            --index;
            tryy.value = stdList[index][0];
            firebase.database().ref('boundary/' + tryy.value).on('value', function(snapshot){
              document.getElementById('myimg').src = snapshot.val().Link;
              ImgNAme.disabled = true;
              ImgNAme.hidden = true;
            })
          }     
  </script>

    <script> //Modal script
      // Get the modal
      var modal = document.getElementById("seemoreModal");
      
      // Get the button that opens the modal
      var btn1 = document.getElementById("myBtn");
      
      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];
      
      // When the user clicks on <span> (x), close the modal
      span.onclick = function() {
        modal.style.display = "none";
        modal.style.zIndex = 1;
      }
      
      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }
      </script>

<script type="text/javascript"> 
  //printing script
    function PrintTable() {
    var printWindow = window.open('', '', 'height=700,width=1200');
    printWindow.document.write('<table>');

    //Print the Table CSS.
    var table_style = document.getElementById("table_style").innerHTML;
    printWindow.document.write('<stylestd type = "text/css">');
    printWindow.document.write(table_style);
    printWindow.document.write('</style>');
    printWindow.document.write('</head>');

    //Print the DIV contents i.e. the HTML Table.
    printWindow.document.write('<body>');
    var divContents = document.getElementById("dvContents").innerHTML;
    printWindow.document.write(divContents);
    printWindow.document.write('</body>');

    printWindow.document.write('</html>');
    printWindow.document.close();
    printWindow.print();
}
</script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script>

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
  </script>

<script>
  let btn= document.querySelector("#btn");
  let sidebar= document.querySelector(".sidebar");

  btn.onclick= function(){
    sidebar.classList.toggle("active");
  }
  </script>
  </body>
</html>
