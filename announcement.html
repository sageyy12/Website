<!DOCTYPE html>
<html>
    <head> <title>Announcement</title>
      <meta charset="utf-8" name="viewport" content= "width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="announcementCSS.css">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
      <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    <body>

      <div class="topnav" id="myTopnav">
        <nav class="nav">
          <div class="logo-content">
            <div class="logo">
              <a href="dashboard.html">
                <img src="images/logo.png"></a>
                  <div class="logo-name">Announcement</div>
                  <button id="logout">Logout</button>
              </div>
          </div>
      </nav>
      </div>
        <div class="sidebar">
            <i class='bx bx-menu' id="btn"></i>
            <ul class="navList">
                <li>
                    <a href="adminProfile.html">
                    <img src="images/admin.png">
                    <span class="links_name">Admin Profile</span>
                    </a>
                    <span class="tooltip">Admin</span>
                </li>
                <li>
                    <a href="announcement.html">
                    <img src="images/announcement.png">
                    <span class="links_name">Announcement</span>
                    </a>
                    <span class="tooltip">Announcement</span>
                </li>
                <li>
                    <a href="ShuttleDriverAcct.html">
                    <img src="images/Shuttle Drivers Account.png">
                    <span class="links_name">Shuttle Driver’s Account</span>
                    </a>
                    <span class="tooltip">Driver</span>
                </li>
                <li>
                    <a href="CoomutersAcct.html">
                    <img src="images/Commuters Account.png">
                    <span class="links_name">Commuter’s Account</span>
                    </a>
                    <span class="tooltip">Commuter</span>
                </li>
                <li>
                    <a href="complaintsNfeedback.html">
                    <img src="images/Complaints and Feedbacks.png">
                    <span class="links_name">Complaints and Feedbacks</span>
                    </a>
                    <span class="tooltip">Complaints</span>
                </li>
                <li>
                    <a href="boundaryRemit.html">
                    <img src="images/Boundary Remittance.png">
                    <span class="links_name">Boundary Remittance</span>
                    </a>
                    <span class="tooltip">Boundary</span>
                </li>
                <li>
                    <a href="reload.html">
                      <!--img src="images/reload.png"!-->
                  <i class='bx bx-wallet'></i>
                    <span class="links_name">Reload</span>
                    </a>
                    <span class="tooltip">Reload</span>
                </li>
                <li>
                  <a href="withdrawal.html">
                    <!--img src="images/reload.png"!-->
                    <i class='bx bx-money-withdraw'></i>
                  <span class="links_name">Withdraw</span>
                  </a>
                  <span class="tooltip">Withdraw</span>
              </li>
            </ul>
        </div>

      <div id="modal">
          <div class="modal-content">
            <div class="modal-header" id="close">
              <h2>Add Announcement</h2>
              <a href="" class="close-btn" onclick="toggle()">&times;</a>
            </div>
            <div class="modal-body">
              <form>
                
                <input type="text" placeholder="TITLE:" id="title">

                 <!-- dropdown  -->
                 <div class="wrapper">
                  <div class="collapsible">
                    <input type="checkbox" id="collapsible-head"> <!-- for the trigger of the collapsible  -->
                
                      <center>
                        <select id="recipient" onchange="r()">
                          <option selected hidden>RECIPIENT</option>
                          <option value="all">ALL</option>
                          <option value="drivers">DRIVERS</option>
                          <option value="commuters">COMMUTER</option>
                        </select>
                    
                      </center>

                     
                <textarea rows="8" cols="80" placeholder="Content:" id="contentlorem"></textarea>

                <input type="hidden" placeholder="DATE:" id="date"><br>
                <input type="hidden" placeholder="TIME:" id="time"><br>
                <input type="hidden" id="text_v">

                <a href="#post" id="Post" onclick="adddd()">Post</a>
                <a href="announcement.html" id="Cancel">Cancel</a>
                 
                       
                      
                      <!-- <label for="collapsible-head">RECIPIENT:</label>
                        <div class="collapsible-text">
                          <center>
                          <p id="driversdp">DRIVERS</p> <hr>
                          <p id="commutersdp">COMMUTERS</p><hr>
                          <p id="alldp">ALL</p>
                        </center> -->
                        </div>
                      </div>
                    </div>
                  </div>
              </form>
            </div>
          </div>

        <div class="container" id="blur">
        <div class="content">
          <span class="upper">
            <img src="images/announce.png">
            <h1>POSTED ANNOUNCEMENTS:</h1>
            <a href="#AddAnnouncement" onclick="toggle()">
              <button id="btnAdd">Add Announcement</button>
            </a>
          </span>
        </div>

        <table class="table table-striped" id="lowertbt">
          <thead>
            <tr>
              <th>ID</th>
              <th id="tbtprofile">TITLE</th>
              <th>RECIPIENT</th>
              <th>CONTENT</th>
              <th>DATE</th>
              <th>TIME</th>
              <th>CONTROL CENTER</th>
            </tr>
          </thead>
          <tbody id="tbody1"></tbody>
        </table>
      </div>

    <footer class="footer-distributed">

        <div class="footer-left">
            <h3>Washington <span>Place</span></h3>

            <p class="footer-links">
                <a href="dashboard.html">Dashboard</a>
                |
                <a href="commutersTable.html">All commuters</a>
                |
                <a href="login.html">Log in</a>
            </p>

            <p id="coltext">DOWNLOAD OUR APP HERE:</p>
            <div class="content">
              <p><a href="https://drive.google.com/file/d/1d8tUT5DQuuEI0k3D9PMNzJ99qE45hrwl/view?usp=sharing"> For commuters click here </a></p>
              <p><a href="https://drive.google.com/file/d/1d8tUT5DQuuEI0k3D9PMNzJ99qE45hrwl/view?usp=sharing"> For drivers click here </a></p>
            </div>
        </div>

        <div class="footer-center">
            <div>
                <i class="fa fa-map-marker"></i>
                <p><span>Sampaloc II, Dasmariñas,</span>
                    <strong>Philippines</strong></p>
            </div>

            <div>
                <i class="fa fa-phone"></i>
                <p>0943 302 9424</p>
            </div>
            <div>
                <i class="fa fa-envelope"></i>
                <p><a href="mailto:peteregencia@yahoo.com">peteregencia@yahoo.com</a></p>
            </div>
            <div>
                <i class="fa fa-facebook"></i>
                <p><a href="https://www.facebook.com/cavitewashington">Washington Place facebook page</a></p>
            </div>
            <div>
              <p class="footer-company-name">Copyright © 2022 <strong>WashingtonPlaceDasmarinas</strong> <br>
                All rights reserved</p>
            </div>
        </div>
        <div class="footer-right">
            <p class="footer-company-about">
                <span>About Washington Place Dasmarinas</span>
                <strong>Washington Place Dasmarinas</strong> Stateland’s newest and to date, the
                grandest development, is set to rise in the emerging city of Dasmariñas in Cavite. Encompassing 40
                hectares of prime property along Aguinaldo Highway, it is envisioned to become a landmark community
                that boasts of modern-themed architectural designs.
            </p>
            <!--div class="footer-icons">
                <a href="https://www.facebook.com/cavitewashington"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
                <a href="#"><i class="fa fa-linkedin"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-youtube"></i></a>
            </div!-->
        </div>
    </footer>
  </div><!-- ending ni blur  -->


  <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-database.js"></script>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  <script id="MainScript">

          const firebaseConfig = {
                  apiKey: "AIzaSyBfq-ptJkg7y-hJpyJrVq8x0PNoM4fT7cY",
                  authDomain: "shuttle-go-8d87a.firebaseapp.com",
                  databaseURL: "https://shuttle-go-8d87a-default-rtdb.firebaseio.com",
                  projectId: "shuttle-go-8d87a",
                  storageBucket: "shuttle-go-8d87a.appspot.com",
                  messagingSenderId: "509853219067",
                  appId: "1:509853219067:web:5e6b7fb55bbdba9cc0985e",
                  measurementId: "G-3YGP2PY9QX"
                };
                firebase.initializeApp(firebaseConfig);

              console.log(firebase);

      function r() {
				var select = document.getElementById('recipient');
				var receipt = select.options[select.selectedIndex];

				document.getElementById('text_v').value = receipt.text;
			}
      r();
                   
        function add_announcement(){
       
           firebase.database().ref("announcement/"+recipient.value).update(
             {
              title:title.value,
              date:date.value,
              time:time.value,
              content:contentlorem.value,
              recipient:text_v.value
             },
             (error)=>{
               if(error){
                 alert("Announcement was not created!" + error);
               }else{
                 alert("Announcement successfully added!");
                 // Select_AllData()
                 //hiding the modal
                 $("#exampleModalCenter").modal('hide'); //exampleModalCenter is the id of the modal component
               }
             }
           )
         }

         function adddd(){
         
         CurrentDate();
         CurrentTime();
         add_announcement();
       }

       function CurrentDate(){

             const datee = new Date();

             let day = datee.getDate();
             let month = datee.getMonth() + 1;
             let year = datee.getFullYear();

             let currentDate = `${month}-${day}-${year}`;
             date.value = (currentDate);

             date.disabled = true;
         }

       function CurrentTime(){
         const currentTime = new Date();
         let hours = currentTime.getHours() > 12 ? currentTime.getHours() - 12 : currentTime.getHours();
         let am_pm = currentTime.getHours() >= 12 ? "pm" : "am";
         let minutes = currentTime.getMinutes() < 10 ? "0" + currentTime.getMinutes() : currentTime.getMinutes();
         let timeee = hours + ":" + minutes + " " + am_pm;
         time.value = (timeee);

         time.disabled = true;

       }  

         //select all data
      function Select_AllData(){
        firebase.database().ref('announcement').once('value', function (snapshot){
          snapshot.forEach(function(childSnapshot){
            var titlee = childSnapshot.val().title;
            var recipientt = childSnapshot.recipient;
            var contentt = childSnapshot.val().content;
            var datee = childSnapshot.val().date;
            var timee = childSnapshot.val().time;
          
            AddItemToTable(titlee, recipientt, contentt, datee, timee);
          });
        });
      }
      // window.onload = Select_AllData;

      var studentNo = 0;
      var stdList = [];

        function AddItemToTable(titlee, recipientt, contentt,datee, timee){
        var tbody1 = document.getElementById("tbody1");
        let trow = document.createElement("tr");
        let td0 = document.createElement("td");
        let td1 = document.createElement("td");
        let td2 = document.createElement("td");
        let td3 = document.createElement("td");
        let td4 = document.createElement("td");
        let td5 = document.createElement("td");
        let td6 = document.createElement("td");
       
        stdList.push([titlee, recipientt, contentt, datee, timee ]);
        
        td0.innerHTML = ++studentNo;
        td1.innerHTML = titlee;
        td2.innerHTML = recipientt;
        td3.innerHTML = contentt;
        td4.innerHTML = datee;
        td5.innerHTML = timee;

        trow.appendChild(td0);
        trow.appendChild(td1);
        trow.appendChild(td2);
        trow.appendChild(td3);
        trow.appendChild(td4);
        trow.appendChild(td5);
        var ControlDiv3 = document.createElement("div3");
        ControlDiv3.innerHTML = '<a href="#" ><i style="color:black"; class= "bx bxs-trash-alt" id="delete" onclick="deletee('+studentNo+')" ></i></a>'
        
        trow.appendChild(ControlDiv3);
        trow.append(td6);
        tbody1.appendChild(trow);

      }

      function AddAllItems(announcement) {
            std=0;
            tbody1.innerHTML="";
            announcement.forEach(element => {
              AddItemToTable(element.title, element.recipient , element.content, element.time, element.date)
            });
          }

          function getAllData() {
              const dbref = firebase.database().ref("announcement");
              get(child(dbref, "annoucement"))
              .then((snapshot) => {
                var commuter = [];
                snapshot.forEach(childSnapshot => {
                  commuter.push(childSnapshot.val());
                });
                AddAllItems(commuter);
              })
          }

          function getAllDataRT() {
              const dbRef = firebase.database().ref("announcement");

              dbRef.on('value', (snapshot)=>{
                var commuters = [];
                snapshot.forEach(childsnapshot => {
                  commuters.push(childsnapshot.val());
                });
                AddAllItems(commuters);
              })
          }

        window.onLoad = getAllDataRT();
</script>


      </body>
      <style>
        /*navbar responsive*/
.topnav {
  overflow: hidden;
  background-color: #3D5A80;
  height: 67px;
}

.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #04AA6D;
  color: white;
}

.topnav .icon {
  display: none;
}

@media screen and (max-width: 600px) {
  .topnav a:not(:first-child) {display: none;}
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
}
      </style>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"> </script>

      <script>
      let btn= document.querySelector("#btn");
      let sidebar= document.querySelector(".sidebar");

      btn.onclick= function(){
        sidebar.classList.toggle("active");
      }

      function doubleClick(){
        let tblData = document.getElementById("modal-invisible-textID");
        tblData.style.backgroundColor = "#ffffff";
        tblData.style.padding = "10px 10px 10px 10px"
        tblData.style.borderRadius = "10px";

        let edittext = document.querySelector(".editmode");
        edittext.innerText = "You're in edit mode";
      }

      //blur
      function toggle(){
        var blur = document.getElementById('blur');
        blur.classList.toggle("active");
      }

      /*const parentContainer = document.querySelector('.read-more-container');
      parentContainer.addEventListener('click', event=>{
        const current = event.target;
        const isReadMoreBtn = current.className.includes('read-more-btn');
        if(!isReadMoreBtn) return;
        const currentText = event.target.parentNode.querySelector('.invisible-text');
        currentText.classList.toggle('invisible-text--show');
        current.textContent = current.textContent.includes('See more') ?
        "See less" : "See more";
      })*/

      //editable Table
      /*$(document).on('click', '.edit', function() {
        $(this).parent().siblings('td.data').each(function() {
          var content = $(this).html();
          $(this).html('<input value="' + content + '" />');
        });
        $(this).siblings('.save').show();
        $(this).siblings('.delete').hide();
        $(this).siblings('.archieve').hide();
        $(this).hide();
      });
      $(document).on('click', '.save', function() {
        $('input').each(function() {
          var content = $(this).val();
          $(this).html(content);
          $(this).contents().unwrap();
        });
        $(this).siblings('.edit').show();
        $(this).siblings('.delete').show();
        $(this).siblings('.archieve').show();
        $(this).hide();
      });
      $(document).on('click', '.delete', function() {
        $(this).parents('tr').remove();
      });
      $('.add').click(function() {
        $(this).parents('table').append('<tr><td contenteditable='true'></td><td contenteditable='true'></td><td contenteditable='true'></td><td><button class="save">Save</button><button class="edit">Edit</button> <button class="delete">Delete</button></td></tr>');
      });*/

      //next page ng table
      // $(document).ready(function() {
      //   $('#lowertbt').DataTable( {
      //     "pagingType": "full_numbers"
      //   } );
      // } );
      </script>
    </html>
